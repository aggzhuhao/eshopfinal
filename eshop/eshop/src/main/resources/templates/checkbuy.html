<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>结算</title>
    <link  type="text/css" href="css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="css/style.css" rel="stylesheet">
    <link type="text/css" href="css/font-awesome.min.css" rel="stylesheet">
    <link type="text/css" href="css/templatemo_style.css" rel="stylesheet">
    <script type="text/javascript" src="js/jquery-1.11.3.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" data-main="js/main" src="js/require.js"></script>
</head>
<body>
<div class="top">
    <div class="container">
        <div class="pull-left top-text">
            <span th:if="${#session?.getAttribute('user')} != null">Hi～亲爱的[(${#session.getAttribute("user")?.username})]</span>
            <a th:if="${#session?.getAttribute('user')}  == null" th:href="@{/login}">登录</a>
            <a th:if="${#session?.getAttribute('user')}  == null" th:href="@{/register}">注册</a>
            <a th:if="${#session?.getAttribute('user')}  != null" th:href="@{/removeuser}">注销</a>
        </div>
        <div th:if="${#session?.getAttribute('user')}  != null" class="pull-right user-info">
            <div class="top-group" style="cursor: pointer">
                我的账户 <i class="icon-angle-down"></i>
                <div class="user-menu">
                    <a href="/article/zhuceyonghu">注册新用户</a></li>
                    <a href="/article/xieyi">用户协议</a></li>
                    <a href="/article/xiugaixinxi">修改信息</a></li>
                </div>
            </div>
            <div class="top-group"><a href="orderlist"><i class="icon-reorder"></i>我的订单</a></div>
            <div class="top-group"><a id="tocart" href="javascript:void(0)"><i class="icon-shopping-cart"></i>购物车</a></div>
        </div>
    </div>
</div>
<div class="header">
    <div class="container">
        <div class="logo pull-left">
            <a href="#">
                <img src="images/logo.png" width="250px" height="100px" >
            </a>
        </div>
        <div class="nav-menu pull-left">
            <ul class="nav navbar-nav">
                <li ><a href="/index">首页</a></li>
                <li ><a href="/shownew">每周新品预售</a></li>
                <li><a href="/discount">限时打折</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="main">
    <div class="container">
        <div class="cart">
            <div class="cart-mark">
                <div class="pull-left">
                </div>
                <div class="pull-right">
                    <div class="cart-process">
                        <div class="line"></div>
                        <div class="process-item">
                            <div>1</div>
                            <p>购物车</p>
                        </div>
                        <div class="process-item ">
                            <div  class="active">2</div>
                            <p>确认订单</p>
                        </div>
                        <div class="process-item">
                            <div>3</div>
                            <p>生成订单</p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="templatemo_main" >
                <div id="content" class="float_r">
                    <h2>结算</h2>
                    <h5><strong>收货人信息</strong></h5>
                    <div class="content_half float_l checkout">
                        收货人姓名:
                        <input id="receiveId" type="text"  style="width:300px;"  />
                        <br />
                        <br />
                        省份:
                        <input id="province" type="text"  style="width:300px;"  />
                        <br />
                        <br />
                        城市:
                        <input id="city" type="text"  style="width:300px;"  />
                        <br />
                        <br />
                        区、县:
                        <input id="country" type="text"  style="width:300px;"  />
                    </div>

                    <div class="content_half float_r checkout">
                        地址
                        <input id="home" type="text"  style="width:300px;" />
                        <br />
                        <br />
                        邮编
                        <input id="postal" type="text"  style="width:300px;"  />
                        <br />
                        <br />
                        电话<br />
                        <span style="font-size:10px">请提供真实有效的电话，以便快递员送货时与您联系.</span>
                        <input id="phone" type="text"  style="width:300px;"  />
                    </div>

                    <div class="cleaner h50"></div>
                    <h3>购物车</h3>
                    <h4>总金额: ￥<strong id="count" th:text="${#session.getAttribute('count')}"></strong></h4>
                    <p><input id="agreement" name="agreement" type="checkbox" />
                        我接受本网站的使用条款.</p>
                    <table style="border:1px solid #CCCCCC;" width="100%">
                        <tr>
                            <td height="80px"> <img src="images/alipay.png" alt="alipay" /></td>
                            <td width="400px;" style="padding: 0px 20px;">推荐使用支付宝付款。使用红包支付，更多实惠！</td>
                            <td><a id="alipay" style="cursor:pointer">支付宝支付</a></td>
                        </tr>
                        <tr>
                            <td  height="80px"><img src="images/wechat.png" alt="wechatpay" />
                            </td>
                            <td  width="400px;" style="padding: 0px 20px;">没有支付宝帐户，不用担心，我们也支持微信支付</td>
                            <td><a id="wechat" style="cursor:pointer">微信支付</a></td>
                        </tr>
                    </table>

                    <br>
                    <a href="javascript:history.back()"><h3>暂不结算，返回</h3></a>
                </div>
            </div>

    </div>
</div>
    <div class="footer">
        <div class="container">
            <div class="footer-group pull-left">
                <ul class="footer-list">
                    <li class="top-title"><span>新手指南</span></li>
                    <li><a href="/article/zhuceyonghu">注册新用户</a></li>
                    <li><a href="/article/xieyi">用户协议</a></li>
                    <li><a href="/article/xiugaixinxi">修改信息</a></li>
                </ul>
                <ul class="footer-list">
                    <li class="top-title"><span>购物指南</span></li>
                    <li><a href="/article/gouwuliucheng">购物流程</a></li>
                </ul>
                <ul class="footer-list">
                    <li class="top-title"><span>购物车</span></li>
                    <li><a href="/article/gouwucheshuoming">购物车说明</a></li>
                </ul>
            </div>
            <div class="footer-group pull-right">
                <div class="contact">
                    <img src="images/contact.jpg">
                </div>
                <p>监督：1038334827</p>
                <p> 在线客服</p>
            </div>
            <div class="copy-right">
                <p><span>CopyRight © 2018-2019 127.0.0.1:8080 right to zh</span></p>
            </div>
        </div>
    </div>
    <div class="sticky">
        <div><a href="#" title="返回顶部"><i class="icon-angle-up"></i></a></div>
    </div>
<div class="sticky">
    <div><a href="#" title="返回顶部"><i class="icon-angle-up"></i></a></div>
</div>
<!--置顶-->

</body>
<script>
    $(function () {
        $("#alipay").click(function () {

            var comformm = confirm("是否确认支付"+$("#count").text());
            if(comformm == true) {
                var result = checkform();
                if (result == false) {
                    alert("请完善订单信息");
                } else if ($("#agreement").is(":checked") == false) {
                    alert("请接受本网站的使用条例");
                } else {
                    var recevice =$("#receiveId").val();
                    var province=$("#province").val();
                    var city=$("#city").val();
                    var county=$("#country").val();
                    var address=$("#home").val();
                    var zipcode=$("#postal").val();
                    var telphone=$("#phone").val();
                    window.location.href="/jiesuanproduct/1/"+recevice+"/"+province+"/"+city+"/"+county+"/"+address+"/"+zipcode+"/"+telphone;
                }
            }
        })

        $("#wechat").click(function () {

           var comformm = confirm("是否确认支付"+$("#count").text());
            if(comformm == true) {
                var result = checkform();
                if (result == false) {
                    alert("请完善订单信息");
                } else if ($("#agreement").is(":checked") == false) {
                    alert("请接受本网站的使用条例");
                } else {
                    $.ajax({
                        url: "/jiesuanproductwechat",
                        data: {

                            payment:2,
                            recevice:$("#receiveId").val(),
                            province:$("#province").val(),
                            city:$("#city").val(),
                            county:$("#country").val(),
                            address:$("#home").val(),
                            zipcode:$("#postal").val(),
                            telphone:$("#phone").val()

                        },
                        success: function (data) {
                            if(data == 1){
                                window.location.href = "/orderlist";
                            }else{
                                alert("购买失败1！");
                            }
                        },error:function () {
                            alert("123");
                        }
                    })
                }
            }

        })

        function checkform(){
            //收货人姓名
            if(($("#receiveId").val() == "")){
                return false;
            }else if($("#province").val() == "") {return false}//省份
            else if($("#city").val() == ""){return false}//城市
            else if($("#country").val() == ""){return false}// 区、县:
            else if($("#home").val() == ""){return false}//地址
            else if($("#postal").val() == ""){return false} //邮编
            else if($("#phone").val() == ""){return false} //电话
            else{
                return true;
            }
        }


        $("#delete").click(function(){
            var deleteId = $("input:[name='rid']:checked");
            window.location.href = "project/deleteById/"+deleteId;
        })

    })
</script>
</html>